.card.mb-4
  %h3.card-header= activity.name
  .card-body
    %h5.card-title= activity.short_description
    .row
      .col-md-9
        - if @source_activities.any?
          %small= t('activities.show.source-activities')
          %ul
            - @source_activities.each do |activity|
              %li= link_to activity.name, activity
        %p= markdown(activity.long_description)
        - if activity.documents.attached?
          %h6= t('activities.show.file-list')
          - activity.documents.each do |document|
            %p= link_to document.blob.filename, url_for(document)
      .col-md-3
        = render "thumbs_up"
        %p= t('activities.show.time_estimate', time_estimate: activity.time_estimate)
        %p
          =t('activities.show.submitted_by')
          =link_to activity.user.username, activity.user
        %p= l(activity.created_at, format: :quite_short)
        - if user_signed_in? && policy(activity).update?
          .btn-group{"role" => "group", "aria-label" => "Activity controls"}
            - if activity.unapproved? || activity.edited?
              = link_to t('activities.show.approve'), approve_activity_path(activity), method: :put, data: { confirm: "Approve this activity?" }, class: "btn btn-outline-secondary btn-sm"
            - elsif activity.approved? && ( policy(activity).unapprove? )
              = link_to t('activities.show.deapprove'), unapprove_activity_path(activity), method: :put, class: "btn btn-outline-secondary btn-sm"
            = link_to t('activities.show.edit'), edit_activity_path(activity), class: "btn btn-outline-secondary btn-sm"
            = link_to t('activities.show.delete'), activity, method: :delete, data: { confirm: t('activities.show.delete_confirmation') }, class: "btn btn-outline-secondary btn-sm"
          %button.btn.btn-secondary.mt-2{"data-toggle"=>"collapse", "data-target"=>"#tag-editor-#{activity.id}", "aria-expanded"=>"false", "aria-controls"=>"tag-editor-#{activity.id}"}= t('activities.show.edit-tags')
          .dynamic-tag-editor.collapse{"id"=>"tag-editor-#{activity.id}"}
            = render "taggings/activity_tagging_list"
            = render "taggings/form"
        - elsif user_signed_in? && activity.user == current_user
          .btn-group.float-right{"role" => "group", "aria-label" => "Activity controls"}
            = link_to t('activities.show.resubmit'), edit_activity_path(activity), class: "btn btn-outline-secondary btn-sm"
  .card-footer{"id" => "activity-#{activity.id}-tags"}
    - activity.tags.each do |tag|
      %span= link_to tag.long_name, tag, class: "badge badge-pill badge-success"
  .card-footer.p-1
    %p.card-text.text-center
      %small.text-muted All content is provided under the #{link_to "Creative Commons Attribution-NonCommercial-ShareAlike 4.0 License",  "https://creativecommons.org/licenses/by-nc-sa/4.0/"}.
  - if @inspired_activities.any?
    .card-footer.p-2
      %small= t('activities.show.inspired-activities')
      %ul
        - @inspired_activities.each do |activity|
          %li
            %span= link_to activity.name, activity

= render partial: 'comments/comment_list', locals: { comments: @comments }

= render partial: 'comments/form', locals: { commentable_type: "Activity", commentable_id: @activity.id }
